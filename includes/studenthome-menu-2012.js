function ioe_createmenus(){if(!document.getElementById)return;if(navigator.userAgent.indexOf("MSIE 5")>=0||navigator.userAgent.indexOf("MSIE 6")>=0)return;e_div=document.getElementById("sh-header-menu");if(e_div==null)return;path="https://msds.open.ac.uk/students/",document.cookie.indexOf("P14MENU=Y")>=0&&(path="http://csintra1.open.ac.uk/students/"),window.ioe_rel!=undefined&&(ioe_rel==1&&(path=""),ioe_rel==2&&(path="https://msds-acct.open.ac.uk/students/"),ioe_rel==3&&(path="../")),showextra=0,ioe_numcrse+ioe_numqual>10&&(showextra=1,ioe_numqual<=3?ioe_numcrse=10-ioe_numqual:ioe_numcrse<=7?ioe_numqual=10-ioe_numcrse:(ioe_numqual=3,ioe_numcrse=7)),typeof window.iox_nf=="undefined"&&(iox_nf="");if(ioe_numcrse+ioe_numqual>0){for(ioeul[0]=document.createElement("ul"),wd=0,ioe_numcrse>0&&(wd=ioe_crsewidth),ioe_numqual>0&&ioe_qualwidth>wd&&(wd=ioe_qualwidth),wd*=.94,lft=181,wd>43&&(lft-=(wd-43)*16),ioeul[0].style.cssText="left:"+lft+"px;",e_div.appendChild(ioeul[0]),i=0;i<ioe_numcrse;i++)ioe_addmenuitem(ioeul[0],ioe_course[i]," "+ioe_crsetitle[i]+" ("+ioe_pres[i].substr(0,4)+")",path+"module.aspx?c="+ioe_course[i]+"_"+ioe_pres[i],ioe_crsetype[i],i==ioe_numcrse-1&&(ioe_numqual>0||showextra||iox_nf!="Q"));for(i=0;i<ioe_numqual;i++)ioe_qualocc[i].length==1?ioe_addmenuitem(ioeul[0],null,ioe_qualtitle[i],path+"research.aspx?t="+ioe_qualocc[i],0,i==ioe_numqual-1&&(showextra||iox_nf!="Q")):ioe_addmenuitem(ioeul[0],null,ioe_qualtitle[i],path+"qual.aspx?q="+ioe_qualocc[i],0,i==ioe_numqual-1&&(showextra||iox_nf!="Q"));showextra&&(ioe_numcrse>0&&ioe_numqual>0?ioe_addmenuitem(ioeul[0],"See all your modules and qualifications \u203a","",path+"study.aspx?stay=1",1,0):ioe_numcrse>0?ioe_addmenuitem(ioeul[0],"See all your modules \u203a","",path+"study.aspx?stay=1",1,0):ioe_addmenuitem(ioeul[0],"See all your qualifications \u203a","",path+"study.aspx?stay=1",1,0)),iox_nf!="Q"&&ioe_addmenuitem(ioeul[0],"Choose your next module \u203a","",path+"next.aspx",1,0)}for(i=0;i<ioeul.length;i++){if(ioeul[i]==null)continue;window.attachEvent&&(ioeul[i].attachEvent("onmouseover",ioe_keepalive),ioeul[i].attachEvent("onmouseout",ioe_hidemenu)),window.addEventListener&&(ioeul[i].addEventListener("mouseover",ioe_keepalive,!1),ioeul[i].addEventListener("mouseout",ioe_hidemenu,!1))}(ioe_numqual>0||ioe_numcrse>0)&&(e_div.style.cssText="display:block"),ioemenus=!0}function ioe_addmenuitem(n,t,i,r,u,f){var e=document.createElement("a"),s,o;e.setAttribute("href",r),t&&(u==1&&t?(s=document.createElement("strong"),s.appendChild(document.createTextNode(t)),e.appendChild(s)):e.appendChild(document.createTextNode(t))),e.appendChild(document.createTextNode(i)),window.attachEvent&&e.attachEvent("onclick",ioe_hidemenu),window.addEventListener&&e.addEventListener("click",ioe_hidemenu,!1),o=document.createElement("li"),f&&(o.className="last"),o.appendChild(e),n.appendChild(o)}function ioe_showmenu(t){if(!ioemenus)return;var u=document.getElementById("ou-org-header"),r=u.clientHeight+43;for(r>=100&&(ioeul[0].style.marginTop=r+"px"),n=-1,t==3&&(n=0),i=0;i<ioeul.length;i++){if(ioeul[i]==null)continue;i!=n?(ioestatus[i]==1&&(ioestatus[i]=201,ioefadetime=new Date),ioestatus[i]==101&&(ioestatus[i]=0,ioefadetime=0),ioestatus[i]==102&&(ioestatus[i]=203,ioefadetime=0),ioestatus[i]==103&&(ioestatus[i]=202,ioefadetime=0),ioestatus[i]>300&&(ioestatus[i]=201)):(ioestatus[i]==0&&(ioestatus[i]=101,ioefadetime=new Date),ioestatus[i]==201&&(ioestatus[i]=1,ioefadetime=0),ioestatus[i]==202&&(ioestatus[i]=103,ioefadetime=0),(ioestatus[i]==203||ioestatus[i]==204)&&(ioestatus[i]=102,ioefadetime=0),ioestatus[i]>300&&(ioestatus[i]=1))}ioe_process(),ioetimer||(ioetimer=window.setInterval("ioe_process()",30))}function ioe_hidemenu(){if(!ioemenus)return;for(i=0;i<ioeul.length;i++)ioestatus[i]==1&&(ioestatus[i]=301),ioestatus[i]==101&&(ioestatus[i]=0),ioestatus[i]==102&&(ioestatus[i]=203),ioestatus[i]==103&&(ioestatus[i]=202);ioe_process()}function ioe_keepalive(){if(!ioemenus)return;for(i=0;i<ioeul.length;i++)ioestatus[i]>300&&(ioestatus[i]=1)}function ioe_process(){var t=!1,n;for(ioefadetime>0&&(dur=new Date-ioefadetime,dur>150&&(t=!0)),i=0;i<ioeul.length;i++){t==!0&&ioestatus[i]>100&&ioestatus[i]<110&&(ioestatus[i]=103),t==!0&&ioestatus[i]>200&&ioestatus[i]<210&&(ioestatus[i]=204);if(ioestatus[i]==101){ioeul[i].style.visibility="visible",ioeul[i].style.opacity="0.33",ioeul[i].style.filter&&(ioeul[i].style.filter="alpha(opacity=33)"),ioestatus[i]=102;continue}if(ioestatus[i]==102){ioeul[i].style.opacity="0.67",ioeul[i].style.filter&&(ioeul[i].style.filter="alpha(opacity=67)"),ioestatus[i]=103;continue}if(ioestatus[i]==103){ioeul[i].style.opacity="1.0",ioeul[i].style.filter&&(ioeul[i].style.filter="alpha(opacity=100)"),ioestatus[i]=1,ioefadetime=0;continue}if(ioestatus[i]==201){ioeul[i].style.opacity="0.75",ioeul[i].style.filter&&(ioeul[i].style.filter="alpha(opacity=75)"),ioestatus[i]=202;continue}if(ioestatus[i]==202){ioeul[i].style.opacity="0.50",ioeul[i].style.filter&&(ioeul[i].style.filter="alpha(opacity=50)"),ioestatus[i]=203;continue}if(ioestatus[i]==203){ioeul[i].style.opacity="0.25",ioeul[i].style.filter&&(ioeul[i].style.filter="alpha(opacity=25)"),ioestatus[i]=204;continue}if(ioestatus[i]==204){ioeul[i].style.visibility="hidden",ioestatus[i]=0,ioefadetime=0;continue}if(ioestatus[i]>300){ioestatus[i]++,ioestatus[i]==315&&(ioestatus[i]=201,ioefadetime=new Date);continue}}for(n=!1,i=0;i<ioeul.length;i++)ioestatus[i]!=0&&(n=!0);n==!1&&(ioetimer&&window.clearInterval(ioetimer),ioetimer=null)}var ioemenus=!1,ioeul=[null],ioestatus=[0],ioetimer=null,ioefadetime=null